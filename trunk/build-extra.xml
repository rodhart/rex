<project name="rex.antlr.extras" basedir="." default="antlr.gen.ecf">
	<!-- ANTLR: Parser Generator -->

	<property name="antlr.grammars.dir" value="${basedir}/grammars" />
	<property name="antlr.gen.dir" value="${basedir}/gen" />
	<property name="antlr.ecf.out.dir" value="${rex_src}/ecfparser/impl/parser" />

	<path id="antlr.classpath">
		<pathelement location="${antlr3-task.name}" />
	</path>
	<taskdef classpathref="antlr.classpath" name="antlr3" classname="org.apache.tools.ant.antlr.ANTLR3"/>

	<macrodef name="myantlr">
	    <attribute name="target"/>
	    <attribute name="outputdirectory"/>
	    <sequential>
	           <echo message="antlr ${grammar}/@{target}" />
	           <antlr3 
	               target="@{target}" 
	               outputdirectory="@{outputdirectory}"
	               libdirectory="@{outputdirectory}"
	               multithreaded="true"
	               report="false"
	               profile="false">
						<classpath>
							<pathelement location="${antlr3.name}" />
						</classpath>
	           </antlr3>
	     </sequential>
	 </macrodef>


	<target name="antlr.gen.ecf" unless="antlr.ecf.Parser.processed"
		description="Generate the parser for ECF format.">
		<myantlr target="${antlr.grammars.dir}/EcfAntlr.g" outputdirectory="${antlr.ecf.out.dir}" />
	</target>
</project>